<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Nginx | Shang Liang Liang's Blog</title><meta name="description" content="Nginx正向代理隐藏真实客户端，反向代理隐藏真实服务端， 正向代理隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，比如VPN。 反向代理客户不知道真正提供服务人的是谁，比如访问www.baidu.com，不知道具体哪个服务器提供服务。主要用于负载均衡。 1. 什么是Nginx？Nginx是一个 轻量级&#x2F;高性能的反向代理Web服务器，他实现非常高效的反向代理、负载平衡，他可以处理2-3万并发"><meta name="keywords" content="Nginx"><meta name="author" content="Shang Liang Liang"><meta name="copyright" content="Shang Liang Liang"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/logo.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="dns-prefetch" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Nginx"><meta name="twitter:description" content="Nginx正向代理隐藏真实客户端，反向代理隐藏真实服务端， 正向代理隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，比如VPN。 反向代理客户不知道真正提供服务人的是谁，比如访问www.baidu.com，不知道具体哪个服务器提供服务。主要用于负载均衡。 1. 什么是Nginx？Nginx是一个 轻量级&#x2F;高性能的反向代理Web服务器，他实现非常高效的反向代理、负载平衡，他可以处理2-3万并发"><meta name="twitter:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gww665phlvj31a40isjst.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Nginx"><meta property="og:url" content="http://yoursite.com/2021/11/17/Java%E9%9D%A2%E8%AF%95/Nginx/"><meta property="og:site_name" content="Shang Liang Liang's Blog"><meta property="og:description" content="Nginx正向代理隐藏真实客户端，反向代理隐藏真实服务端， 正向代理隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，比如VPN。 反向代理客户不知道真正提供服务人的是谁，比如访问www.baidu.com，不知道具体哪个服务器提供服务。主要用于负载均衡。 1. 什么是Nginx？Nginx是一个 轻量级&#x2F;高性能的反向代理Web服务器，他实现非常高效的反向代理、负载平衡，他可以处理2-3万并发"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gww665phlvj31a40isjst.jpg"><meta property="article:published_time" content="2021-11-17T09:53:31.000Z"><meta property="article:modified_time" content="2022-02-21T01:12:43.316Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://yoursite.com/2021/11/17/Java%E9%9D%A2%E8%AF%95/Nginx/"><link rel="prev" title="Kafka数据可靠性和一致性" href="http://yoursite.com/2021/11/18/Java%E9%9D%A2%E8%AF%95/Kafka%E6%95%B0%E6%8D%AE%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%92%8C%E4%B8%80%E8%87%B4%E6%80%A7/"><link rel="next" title="5.1.二叉树思维导图" href="http://yoursite.com/2021/11/16/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/5.1.%E4%BA%8C%E5%8F%89%E6%A0%91%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?16c6948b730158e8efcea17a55c7ca6d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: Shang Liang Liang","link":"链接: ","source":"来源: Shang Liang Liang's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: {"text":"求知,好学","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: false,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Shang Liang Liang's Blog" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">57</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">14</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">14</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx"><span class="toc-text">Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-什么是Nginx？"><span class="toc-text">1. 什么是Nginx？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-为什么要用Nginx？"><span class="toc-text">2. 为什么要用Nginx？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-为什么Nginx性能这么高？"><span class="toc-text">&#x3D;&#x3D;3. 为什么Nginx性能这么高？&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Nginx怎么处理请求的？"><span class="toc-text">&#x3D;&#x3D;4. Nginx怎么处理请求的？&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Nginx的优缺点？"><span class="toc-text">&#x3D;&#x3D;5. Nginx的优缺点？&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-如何用Nginx解决前端跨域问题？"><span class="toc-text">6. 如何用Nginx解决前端跨域问题？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nginx配置文件nginx-conf有哪些属性模块"><span class="toc-text">Nginx配置文件nginx.conf有哪些属性模块?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-Nginx虚拟主机怎么配置"><span class="toc-text">7. Nginx虚拟主机怎么配置?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-限流怎么做的？"><span class="toc-text">&#x3D;&#x3D;8. 限流怎么做的？&#x3D;&#x3D;</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1、正常限制访问频率（正常流量）："><span class="toc-text">1、正常限制访问频率（正常流量）：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2、突发限制访问频率（突发流量）："><span class="toc-text">2、突发限制访问频率（突发流量）：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3、-限制并发连接数"><span class="toc-text">3、 限制并发连接数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-漏桶流算法和令牌桶算法知道？"><span class="toc-text">9. 漏桶流算法和令牌桶算法知道？</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#漏桶算法"><span class="toc-text">漏桶算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#令牌桶算法"><span class="toc-text">令牌桶算法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-为什么要做动静分离？"><span class="toc-text">10. 为什么要做动静分离？</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Nginx怎么做的动静分离？"><span class="toc-text">Nginx怎么做的动静分离？</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-Nginx负载均衡的算法怎么实现的-策略有哪些"><span class="toc-text">&#x3D;&#x3D;11. Nginx负载均衡的算法怎么实现的?策略有哪些?&#x3D;&#x3D;</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-轮询-默认"><span class="toc-text">1. 轮询(默认)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-权重-weight"><span class="toc-text">2. 权重 weight</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-ip-hash-IP绑定"><span class="toc-text">3. ip_hash( IP绑定)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-fair-第三方插件-（略）"><span class="toc-text">4. fair(第三方插件) （略）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-url-hash-第三方插件-（略）"><span class="toc-text">5. url_hash(第三方插件) （略）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-Nginx配置高可用性怎么配置？"><span class="toc-text">&#x3D;&#x3D;12. Nginx配置高可用性怎么配置？&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-Nginx怎么判断别IP不可访问？"><span class="toc-text">13. Nginx怎么判断别IP不可访问？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-怎么限制浏览器访问？"><span class="toc-text">14. 怎么限制浏览器访问？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-Nginx-和-Apache、Tomcat-之间的不同点"><span class="toc-text">&#x3D;&#x3D;15. Nginx 和 Apache、Tomcat 之间的不同点&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-请解释什么是C10K问题"><span class="toc-text">16. 请解释什么是C10K问题?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-nginx中500、502、503、504-有什么区别？"><span class="toc-text">17. nginx中500、502、503、504 有什么区别？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-Nginx-压缩了解吗，如何开启压缩？"><span class="toc-text">18. Nginx 压缩了解吗，如何开启压缩？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19-用Nginx服务器解释-s的目的是什么"><span class="toc-text">19. 用Nginx服务器解释-s的目的是什么?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#20-请解释ngx-http-upstream-module的作用是什么"><span class="toc-text">20. 请解释ngx_http_upstream_module的作用是什么?</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="color"></div><div class="post-bg" id="nav" style="background-image: url(https://tva1.sinaimg.cn/large/008i3skNly1gww665phlvj31a40isjst.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Shang Liang Liang's Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Nginx</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2021-11-17 17:53:31"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2021-11-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-02-21 09:12:43"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2022-02-21</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Nginx/">Nginx</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3.8k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 12 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h1><p><strong>正向代理</strong>隐藏真实客户端，<strong>反向代理</strong>隐藏真实服务端，</p>
<p>正向代理隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，比如VPN。</p>
<p>反向代理客户不知道真正提供服务人的是谁，比如访问<a href="http://www.baidu.com，不知道具体哪个服务器提供服务。主要用于负载均衡。" target="_blank" rel="noopener">www.baidu.com，不知道具体哪个服务器提供服务。主要用于负载均衡。</a></p>
<h4 id="1-什么是Nginx？"><a href="#1-什么是Nginx？" class="headerlink" title="1. 什么是Nginx？"></a>1. 什么是Nginx？</h4><p>Nginx是一个 轻量级/高性能的反向代理Web服务器，他实现非常高效的反向代理、负载平衡，他可以处理2-3万并发连接数，官方监测能支持5万并发，现在中国使用nginx网站用户有很多，例如：新浪、网易、 腾讯等。</p>
<h4 id="2-为什么要用Nginx？"><a href="#2-为什么要用Nginx？" class="headerlink" title="2. 为什么要用Nginx？"></a>2. 为什么要用Nginx？</h4><ul>
<li><strong>跨平台、配置简单、反向代理、高并发连接</strong>：处理2-3万并发连接数，官方监测能支持5万并发，内存消耗小：开启10个nginx才占150M内存 ，nginx处理静态文件好，耗费内存少</li>
<li><strong>健康检查功能</strong>：如果有一个服务器宕机，会做一个健康检查，再发送的请求就不会发送到宕机的服务器了。重新将请求提交到其他的节点上。</li>
</ul>
<h4 id="3-为什么Nginx性能这么高？"><a href="#3-为什么Nginx性能这么高？" class="headerlink" title="==3. 为什么Nginx性能这么高？=="></a>==3. 为什么Nginx性能这么高？==</h4><p>因为他的事件处理机制：异步非阻塞事件处理机制：运用了epoll模型，提供了一个队列，排队解决</p>
<h4 id="4-Nginx怎么处理请求的？"><a href="#4-Nginx怎么处理请求的？" class="headerlink" title="==4. Nginx怎么处理请求的？=="></a>==4. Nginx怎么处理请求的？==</h4><p>nginx接收一个请求后，首先由listen和server_name指令匹配server模块，再匹配server模块里的location，location就是实际地址</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;            		    					<span class="hljs-comment"># 第一个Server区块开始，表示一个独立的虚拟主机站点</span><br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>；      		        <span class="hljs-comment"># 提供服务的端口，默认80</span><br>    server_name  localhost；    				<span class="hljs-comment"># 提供服务的域名主机名</span><br>    location / &#123;            	         <span class="hljs-comment"># 第一个location区块开始</span><br>        <span class="hljs-attribute">root</span>   html；       						<span class="hljs-comment"># 站点的根目录，相当于Nginx的安装目录</span><br>        index  index.html index.htm； <span class="hljs-comment"># 默认的首页文件，多个用空格分开</span><br>    &#125;          												<span class="hljs-comment"># 第一个location区块结果</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="5-Nginx的优缺点？"><a href="#5-Nginx的优缺点？" class="headerlink" title="==5. Nginx的优缺点？=="></a>==5. Nginx的优缺点？==</h4><ul>
<li>优点：<ol>
<li>占内存小，可实现高并发连接，处理响应快</li>
<li>可实现http服务器、虚拟主机、方向代理、负载均衡</li>
<li>Nginx配置简单</li>
<li>可以不暴露正式的服务器IP地址</li>
</ol>
</li>
<li>缺点： 动态处理差：nginx处理静态文件好,耗费内存少，但是处理动态页面则很鸡肋，现在一般前端用nginx作为反向代理抗住压力</li>
</ul>
<h4 id="6-如何用Nginx解决前端跨域问题？"><a href="#6-如何用Nginx解决前端跨域问题？" class="headerlink" title="6. 如何用Nginx解决前端跨域问题？"></a>6. 如何用Nginx解决前端跨域问题？</h4><p>使用Nginx转发请求。把跨域的接口写成调本域的接口，然后将这些接口转发到真正的请求地址。</p>
<h3 id="Nginx配置文件nginx-conf有哪些属性模块"><a href="#Nginx配置文件nginx-conf有哪些属性模块" class="headerlink" title="Nginx配置文件nginx.conf有哪些属性模块?"></a>Nginx配置文件nginx.conf有哪些属性模块?</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#Master进程：读取及评估配置和维持</span><br><span class="hljs-comment">#Worker进程：处理请求</span><br><span class="hljs-attribute">worker_processes</span>  <span class="hljs-number">1</span>；                			<span class="hljs-comment"># worker进程的数量</span><br>events &#123;                              			<span class="hljs-comment"># 事件区块开始</span><br>    <span class="hljs-attribute">worker_connections</span>  <span class="hljs-number">1024</span>；          		<span class="hljs-comment"># 每个worker进程支持的最大连接数</span><br>&#125;                               					<span class="hljs-comment"># 事件区块结束</span><br>http &#123;                           						<span class="hljs-comment"># HTTP区块开始</span><br>    <span class="hljs-attribute">include</span>       mime.types；         			<span class="hljs-comment"># Nginx支持的媒体类型库文件</span><br>    default_type  application/octet-stream；  <span class="hljs-comment"># 默认的媒体类型</span><br>    sendfile        <span class="hljs-literal">on</span>；       								<span class="hljs-comment"># 开启高效传输模式</span><br>    keepalive_timeout  <span class="hljs-number">65</span>；       							<span class="hljs-comment"># 连接超时</span><br>    server &#123;            		                <span class="hljs-comment"># 第一个Server区块开始，表示一个独立的虚拟主机站点</span><br>        <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>；      			        <span class="hljs-comment"># 提供服务的端口，默认80</span><br>        server_name  localhost；    					<span class="hljs-comment"># 提供服务的域名主机名</span><br>        location / &#123;            	        	<span class="hljs-comment"># 第一个location区块开始</span><br>            <span class="hljs-attribute">root</span>   html；       								<span class="hljs-comment"># 站点的根目录，相当于Nginx的安装目录</span><br>            index  index.html index.htm；       	<span class="hljs-comment"># 默认的首页文件，多个用空格分开</span><br>        &#125;          				        							<span class="hljs-comment"># 第一个location区块结果</span><br>        error_page   <span class="hljs-number">500502503504</span>  /50x.html；    <span class="hljs-comment"># 出现对应的http状态码时，使用50x.html回应客户</span><br>        location = /50x.html &#123;          	        <span class="hljs-comment"># location区块开始，访问50x.html</span><br>            <span class="hljs-attribute">root</span>   html；      		      	        <span class="hljs-comment"># 指定对应的站点目录为html</span><br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<h4 id="7-Nginx虚拟主机怎么配置"><a href="#7-Nginx虚拟主机怎么配置" class="headerlink" title="7. Nginx虚拟主机怎么配置?"></a>7. Nginx虚拟主机怎么配置?</h4><ul>
<li><p>1、基于域名的虚拟主机，通过域名来区分虚拟主机——应用：外部网站</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#当客户端访问www.lijie.com,监听端口号为80,直接跳转到data/www目录下文件</span><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span>  www.lijie.com;<br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">root</span>   data/www;<br>        <span class="hljs-attribute">index</span>  index.html index.htm;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>2、基于端口的虚拟主机，通过端口来区分虚拟主机——应用：公司内部网站，外部网站的管理后台</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#当客户端访问www.lijie.com,监听端口号为8080,直接跳转到data/www目录下文件</span><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">8080</span>;<br>    <span class="hljs-attribute">server_name</span>  <span class="hljs-number">8080</span>.lijie.com;<br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">root</span>   data/www;<br>        <span class="hljs-attribute">index</span>  index.html index.htm;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>3、基于ip的虚拟主机。</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#当客户端访问www.lijie.com,监听端口号为80直接跳转到真实ip服务器地址 127.0.0.1:8080</span><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span>  www.lijie.com;<br>    <span class="hljs-attribute">location</span> / &#123;<br>		<span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:8080;<br>        <span class="hljs-attribute">index</span>  index.html index.htm;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="8-限流怎么做的？"><a href="#8-限流怎么做的？" class="headerlink" title="==8. 限流怎么做的？=="></a>==8. 限流怎么做的？==</h4><ul>
<li>Nginx限流就是限制用户请求速度，防止服务器受不了</li>
<li>限流有3种<ol>
<li>正常限制访问频率（正常流量）</li>
<li>突发限制访问频率（突发流量）</li>
<li>限制并发连接数</li>
</ol>
</li>
<li>Nginx的限流都是基于漏桶流算法</li>
</ul>
<h5 id="1、正常限制访问频率（正常流量）："><a href="#1、正常限制访问频率（正常流量）：" class="headerlink" title="1、正常限制访问频率（正常流量）："></a>1、正常限制访问频率（正常流量）：</h5><ul>
<li><p>限制一个用户发送的请求，我Nginx多久接收一个请求。</p>
</li>
<li><p>Nginx中使用ngx_http_limit_req_module模块来限制的访问频率，限制的原理实质是基于漏桶算法原理来实现的。在nginx.conf配置文件中可以使用limit_req_zone命令及limit_req命令限制单个IP的请求处理频率。</p>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs nginx">#定义限流维度，一个用户一分钟一个请求进来，多余的全部漏掉<br> #1r/s代表1秒一个请求，1r/m一分钟接收一个请求， 如果Nginx这时还有别人的请求没有处理完，Nginx就会拒绝处理该用户请求。<br>limit_req_zone $binary_remote_addr zone=one:10m rate=1r/m;<br><br>#绑定限流维度<br>server&#123;<br>		location/seckill.html&#123;<br>		limit_req zone=zone;	<br>		proxy_pass http://lj_seckill;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="2、突发限制访问频率（突发流量）："><a href="#2、突发限制访问频率（突发流量）：" class="headerlink" title="2、突发限制访问频率（突发流量）："></a>2、突发限制访问频率（突发流量）：</h5><ul>
<li>上面的配置一定程度可以限制访问频率，但是也存在着一个问题：如果突发流量超出请求被拒绝处理，无法处理活动时候的突发流量，这时候应该如何进一步处理呢？Nginx提供<strong>burst</strong>参数结合<strong>nodelay</strong>参数可以解决流量突发的问题，可以设置能处理的超过设置的请求数外能额外处理的请求数。我们可以将之前的例子添加burst参数以及nodelay参数：</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs nginx">#定义限流维度，一个用户一分钟一个请求进来，多余的全部漏掉<br>limit_req_zone $binary_remote_addr zone=one:10m rate=1r/m;<br><br>#绑定限流维度<br>server&#123;<br>	location/seckill.html&#123;<br>		limit_req zone=zone burst=5 nodelay;<br> #为什么就多了一个 burst=5 nodelay; 呢，多了这个可以代表Nginx对于一个用户的请求会立即处理前五个，多余的就慢慢来落，没有其他用户的请求我就处理你的，有其他的请求的话我Nginx就漏掉不接受你的请求<br>		proxy_pass http://lj_seckill;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3、-限制并发连接数"><a href="#3、-限制并发连接数" class="headerlink" title="3、 限制并发连接数"></a>3、 限制并发连接数</h5><ul>
<li>Nginx中的ngx_http_limit_conn_module模块提供了限制并发连接数的功能，可以使用limit_conn_zone指令以及limit_conn执行进行配置。接下来我们可以通过一个简单的例子来看下：</li>
</ul>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs nginx">  <span class="hljs-section">http</span> &#123;<br>		<span class="hljs-attribute">limit_conn_zone</span> <span class="hljs-variable">$binary_remote_addr</span> zone=myip:<span class="hljs-number">10m</span>;<br>		<span class="hljs-attribute">limit_conn_zone</span> <span class="hljs-variable">$server_name</span> zone=myServerName:<span class="hljs-number">10m</span>;<br>  &#125;<br><span class="hljs-comment">#配置了单个IP同时并发连接数最多只能10个连接，并且设置了整个虚拟服务器同时最大并发数最多只能100个链接。当然，只有当请求的header被服务器处理后，虚拟服务器的连接数才会计数</span><br>  <span class="hljs-section">server</span> &#123;<br>      <span class="hljs-attribute">location</span> / &#123;<br>          <span class="hljs-attribute">limit_conn</span> myip <span class="hljs-number">10</span>;<br>          <span class="hljs-attribute">limit_conn</span> myServerName <span class="hljs-number">100</span>;<br>          <span class="hljs-attribute">rewrite</span> / http://www.lijie.net <span class="hljs-literal">permanent</span>;<br>      &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<h4 id="9-漏桶流算法和令牌桶算法知道？"><a href="#9-漏桶流算法和令牌桶算法知道？" class="headerlink" title="9. 漏桶流算法和令牌桶算法知道？"></a>9. 漏桶流算法和令牌桶算法知道？</h4><h5 id="漏桶算法"><a href="#漏桶算法" class="headerlink" title="漏桶算法"></a>漏桶算法</h5><ul>
<li><p>漏桶算法是网络世界中流量整形或速率限制时经常使用的一种算法，它的主要目的是控制数据注入到网络的速率，平滑网络上的突发流量。漏桶算法提供了一种机制，通过它，突发流量可以被整形以便为网络提供一个稳定的流量。也就是我们刚才所讲的情况。漏桶算法提供的机制实际上就是刚才的案例：</p>
<p><strong>突发流量会进入到一个漏桶，漏桶会按照我们定义的速率依次处理请求，如果水流过大也就是突发流量过大就会直接溢出，则多余的请求会被拒绝。所以漏桶算法能控制数据的传输速率。</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gww652vuddj305x07ma9z.jpg" alt="在这里插入图片描述"></p>
</li>
</ul>
<h5 id="令牌桶算法"><a href="#令牌桶算法" class="headerlink" title="令牌桶算法"></a>令牌桶算法</h5><ul>
<li>令牌桶算法是网络流量整形和速率限制中最常使用的一种算法。典型情况下，令牌桶算法用来控制发送到网络上的数据的数目，并允许突发数据的发送。Google开源项目Guava中的RateLimiter使用的就是令牌桶控制算法。<strong>令牌桶算法的机制如下：存在一个大小固定的令牌桶，会以恒定的速率源源不断产生令牌。如果令牌消耗速率小于生产令牌的速度，令牌就会一直产生直至装满整个令牌桶。</strong></li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gww6529s0oj30n70b2wew.jpg" alt="在这里插入图片描述"></p>
<h4 id="10-为什么要做动静分离？"><a href="#10-为什么要做动静分离？" class="headerlink" title="10. 为什么要做动静分离？"></a>10. 为什么要做动静分离？</h4><ul>
<li>Nginx是当下最热的Web容器，网站优化的重要点在于静态化网站，网站静态化的关键点则是是动静分离，动静分离是让动态网站里的动态网页根据一定规则把不变的资源和经常变的资源区分开来，动静资源做好了拆分以后，我们则根据静态资源的特点将其做缓存操作。</li>
<li>让静态的资源只走静态资源服务器，动态的走动态的服务器</li>
<li>Nginx的静态处理能力很强，但是动态处理能力不足，因此，在企业中常用动静分离技术。</li>
<li>对于静态资源比如图片，js，css等文件，我们则在反向代理服务器nginx中进行缓存。这样浏览器在请求一个静态资源时，代理服务器nginx就可以直接处理，无需将请求转发给后端服务器tomcat。 若用户请求的动态文件，比如servlet,jsp则转发给Tomcat服务器处理，从而实现动静分离。这也是反向代理服务器的一个重要的作用。</li>
</ul>
<h5 id="Nginx怎么做的动静分离？"><a href="#Nginx怎么做的动静分离？" class="headerlink" title="Nginx怎么做的动静分离？"></a>Nginx怎么做的动静分离？</h5><ul>
<li>只需要指定路径对应的目录。location/可以使用正则表达式匹配。并指定对应的硬盘中的目录。</li>
</ul>
<h4 id="11-Nginx负载均衡的算法怎么实现的-策略有哪些"><a href="#11-Nginx负载均衡的算法怎么实现的-策略有哪些" class="headerlink" title="==11. Nginx负载均衡的算法怎么实现的?策略有哪些?=="></a>==11. Nginx负载均衡的算法怎么实现的?策略有哪些?==</h4><ul>
<li><p>为了避免服务器崩溃，Nginx会通过负载均衡的方式来分担服务器压力。将多台服务器组成一个集群，当用户访问时，先访问到一个转发服务器，再由转发服务器将访问分发到压力更小的服务器。</p>
</li>
<li><p>Nginx负载均衡实现的策略有以下五种：</p>
</li>
</ul>
<h5 id="1-轮询-默认"><a href="#1-轮询-默认" class="headerlink" title="1. 轮询(默认)"></a>1. 轮询(默认)</h5><ul>
<li>每个请求按时间顺序逐一分配到不同的后端服务器，如果后端某个服务器宕机，能自动剔除故障系统。</li>
</ul>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">upstream</span> backserver &#123; <br> <span class="hljs-attribute">server</span> <span class="hljs-number">192.168.0.12</span>; <br> <span class="hljs-attribute">server</span> <span class="hljs-number">192.168.0.13</span>; <br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="2-权重-weight"><a href="#2-权重-weight" class="headerlink" title="2. 权重 weight"></a>2. 权重 weight</h5><ul>
<li>weight权重越高，在被访问的概率越大，如下例，分别是20%，80%。</li>
<li>到的访问概率越高，主要用于后端每台服务器性能不均衡的情况下。其次是为在主从的情况下设置不同的权值，达到合理有效的地利用主机资源。</li>
</ul>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">upstream</span> backserver &#123; <br> <span class="hljs-attribute">server</span> <span class="hljs-number">192.168.0.12</span> weight=<span class="hljs-number">2</span>; <br> <span class="hljs-attribute">server</span> <span class="hljs-number">192.168.0.13</span> weight=<span class="hljs-number">8</span>; <br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-ip-hash-IP绑定"><a href="#3-ip-hash-IP绑定" class="headerlink" title="3. ip_hash( IP绑定)"></a>3. ip_hash( IP绑定)</h5><ul>
<li>每个请求按访问IP的哈希结果分配，使来自同一个IP的访客固定访问一台后端服务器，<strong>==并且可以有效解决动态网页存在的session共享问题==</strong></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx">upstream backserver &#123; <br> ip_hash; <br> server 192.168.0.12:88; <br> server 192.168.0.13:80; <br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="4-fair-第三方插件-（略）"><a href="#4-fair-第三方插件-（略）" class="headerlink" title="4. fair(第三方插件) （略）"></a>4. fair(第三方插件) （略）</h5><h5 id="5-url-hash-第三方插件-（略）"><a href="#5-url-hash-第三方插件-（略）" class="headerlink" title="5. url_hash(第三方插件) （略）"></a>5. url_hash(第三方插件) （略）</h5><h4 id="12-Nginx配置高可用性怎么配置？"><a href="#12-Nginx配置高可用性怎么配置？" class="headerlink" title="==12. Nginx配置高可用性怎么配置？=="></a>==12. Nginx配置高可用性怎么配置？==</h4><ul>
<li>当上游服务器(真实访问服务器)，一旦出现故障或者是没有及时相应的话，应该直接轮训到下一台服务器，保证服务器的高可用</li>
</ul>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>        <span class="hljs-attribute">server_name</span>  www.lijie.com;<br>        <span class="hljs-attribute">location</span> / &#123;<br>		    						<span class="hljs-comment">### 指定上游服务器负载均衡服务器</span><br>		    						<span class="hljs-attribute">proxy_pass</span> http://backServer;<br>										<span class="hljs-comment">###nginx与上游服务器(真实访问的服务器)超时时间 后端服务器连接的超时时间_发起握手等候响应超时时间</span><br>										<span class="hljs-attribute">proxy_connect_timeout</span> <span class="hljs-number">1s</span>;<br>										<span class="hljs-comment">###nginx发送给上游服务器(真实访问的服务器)超时时间</span><br>            				<span class="hljs-attribute">proxy_send_timeout</span> <span class="hljs-number">1s</span>;<br>										<span class="hljs-comment">### nginx接受上游服务器(真实访问的服务器)超时时间</span><br>            				<span class="hljs-attribute">proxy_read_timeout</span> <span class="hljs-number">1s</span>;<br>            				<span class="hljs-attribute">index</span>  index.html index.htm;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<h4 id="13-Nginx怎么判断别IP不可访问？"><a href="#13-Nginx怎么判断别IP不可访问？" class="headerlink" title="13. Nginx怎么判断别IP不可访问？"></a>13. Nginx怎么判断别IP不可访问？</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># 如果访问的ip地址为192.168.9.115,则返回403</span><br><span class="hljs-attribute">if</span>  (<span class="hljs-variable">$remote_addr</span> = <span class="hljs-number">192.168.9.115</span>) &#123;  <br>     <span class="hljs-attribute">return</span> <span class="hljs-number">403</span>;  <br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="14-怎么限制浏览器访问？"><a href="#14-怎么限制浏览器访问？" class="headerlink" title="14. 怎么限制浏览器访问？"></a>14. 怎么限制浏览器访问？</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">## 不允许谷歌浏览器访问 如果是谷歌浏览器返回500</span><br><span class="hljs-attribute">if</span> (<span class="hljs-variable">$http_user_agent</span> <span class="hljs-regexp">~ Chrome)</span> &#123;   <br>    <span class="hljs-attribute">return</span> <span class="hljs-number">500</span>;  <br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="15-Nginx-和-Apache、Tomcat-之间的不同点"><a href="#15-Nginx-和-Apache、Tomcat-之间的不同点" class="headerlink" title="==15. Nginx 和 Apache、Tomcat 之间的不同点=="></a>==15. <strong>Nginx 和 Apache、Tomcat 之间的不同点</strong>==</h4><p>1、Nginx/Apache 是Web Server,而Apache Tomact是一个servlet container </p>
<p>2、tomcat可以对jsp进行解析，nginx和apache只是web服务器，可以简单理解为只能提供html静态文件服务。</p>
<p><strong>Nginx和Apache区别：</strong></p>
<p>最核心的区别在于apache是同步多进程模型，一个连接对应一个进程，nginx是异步的，多个连接可以对应一个进程。</p>
<p>1）Nginx轻量级，同样起web 服务，比apache占用更少的内存及资源 。</p>
<p>2）Nginx 抗并发，nginx 处理请求是异步非阻塞的，而apache 则是阻塞型的，在高并发下nginx 能保持低资源低消耗高性能 。</p>
<p>3）Nginx提供负载均衡，可以做做反向代理，前端服务器。</p>
<p>4）Nginx多进程单线程，异步非阻塞；Apache多进程同步，阻塞。</p>
<h4 id="16-请解释什么是C10K问题"><a href="#16-请解释什么是C10K问题" class="headerlink" title="16. 请解释什么是C10K问题?"></a>16. 请解释什么是<code>C10K</code>问题?</h4><p><code>C10K</code>问题是指无法同时处理大量客户端(10,000)的网络套接字。</p>
<h4 id="17-nginx中500、502、503、504-有什么区别？"><a href="#17-nginx中500、502、503、504-有什么区别？" class="headerlink" title="17. nginx中500、502、503、504 有什么区别？"></a>17. <strong>nginx中500、502、503、504 有什么区别？</strong></h4><p><strong>500</strong>：Internal Server Error 内部服务错误，比如脚本错误，编程语言语法错误。</p>
<p><strong>502</strong>：Bad Gateway错误，网关错误。比如服务器当前连接太多，响应太慢，页面素材太多、带宽慢。</p>
<p><strong>503</strong>：Service Temporarily Unavailable，服务不可用，web服务器不能处理HTTP请求，可能是临时超载或者是服务器进行停机维护。</p>
<p><strong>504</strong>：Gateway timeout 网关超时，程序执行时间过长导致响应超时，例如程序需要执行20秒，而nginx最大响应等待时间为10秒，这样就会出现超时。</p>
<h4 id="18-Nginx-压缩了解吗，如何开启压缩？"><a href="#18-Nginx-压缩了解吗，如何开启压缩？" class="headerlink" title="18. Nginx 压缩了解吗，如何开启压缩？"></a>18. <strong>Nginx 压缩了解吗，如何开启压缩？</strong></h4><p>开启nginx gzip压缩后，图片、css、js等静态资源的大小会减小，可节省带宽，提高传输效率，但是会消耗CPU资源。</p>
<h4 id="19-用Nginx服务器解释-s的目的是什么"><a href="#19-用Nginx服务器解释-s的目的是什么" class="headerlink" title="19. 用Nginx服务器解释-s的目的是什么?"></a>19. 用Nginx服务器解释-s的目的是什么?</h4><p>用于运行nginx -s参数的可执行文件</p>
<h4 id="20-请解释ngx-http-upstream-module的作用是什么"><a href="#20-请解释ngx-http-upstream-module的作用是什么" class="headerlink" title="20. 请解释ngx_http_upstream_module的作用是什么?"></a>20. 请解释<code>ngx_http_upstream_module</code>的作用是什么?</h4><p><code>ngx_http_upstream_module</code>用于定义可通过<code>fastcgi</code>传递、<code>proxy</code>传递、<code>uwsgi</code>传递、<code>memcached</code>传递和scgi传递指令来引用的服务器组。</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Shang Liang Liang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2021/11/17/Java%E9%9D%A2%E8%AF%95/Nginx/">http://yoursite.com/2021/11/17/Java%E9%9D%A2%E8%AF%95/Nginx/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">Shang Liang Liang's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Nginx/">Nginx</a></div><div class="post_share"><div class="social-share" data-image="https://imgchr.com/i/YI6RDH" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2021/11/18/Java%E9%9D%A2%E8%AF%95/Kafka%E6%95%B0%E6%8D%AE%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%92%8C%E4%B8%80%E8%87%B4%E6%80%A7/"><img class="prev_cover" src="https://tva1.sinaimg.cn/large/008i3skNly1gwvtnero3ij31hn0u00ts.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Kafka数据可靠性和一致性</div></div></a></div><div class="next-post pull_right"><a href="/2021/11/16/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/5.1.%E4%BA%8C%E5%8F%89%E6%A0%91%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/"><img class="next_cover" src="https://tva1.sinaimg.cn/large/008i3skNly1gwkue98fd3j30mx0cmgmm.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">5.1.二叉树思维导图</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'http://yoursite.com/2021/11/17/Java%E9%9D%A2%E8%AF%95/Nginx/';
  this.page.identifier = '2021/11/17/Java面试/Nginx/';
  this.page.title = 'Nginx';
};
(function() { 
  var d = document, s = d.createElement('script');
  s.src = 'https://jackshang.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2026 By Shang Liang Liang</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="/js/third-party/ClickShowText.js"></script><script src="/js/search/local-search.js"></script><script>if (document.getElementsByClassName('mermaid').length) {
  loadScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js',function () {
    mermaid.initialize({
      theme: 'default',
  })
})
}</script></body></html>